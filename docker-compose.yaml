version: '3'

services:

  frontend:
    labels:
      shipyard.route: '/'
    build: 'frontend'
    environment:
      CI: 'true'
      DANGEROUSLY_DISABLE_HOST_CHECK: 'true'
    volumes:
      - './frontend/src:/srv/src'
    ports:
      - '5173:5173'

  backend:
    labels:
      shipyard.route: '/api'
    build: 'backend'
    environment:
      DEBUG: 'app'
      OPEN_LEGISLATION_KEY: ${OPEN_LEGISLATION_KEY}
    volumes:
      - './backend/src:/srv/src'
    ports:
      - '3001:3001'
    depends_on:
      - redis

  redis:
    image: redis:latest
    volumes:
      - 'redis_data:/data'
    ports:
      - '6379:6379'

volumes:
  redis_data:
